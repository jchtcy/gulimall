# 一、后台添加秒杀商品
````
1、网关配置路由
- id: coupon_route
  uri: lb://gulimall-coupon
  predicates:
    - Path=/api/coupon/**
  filters:
    - RewritePath=/api/(?<segment>.*),/$\{segment}
    
2、复制优惠相关前端

3、优惠服务修改时区
spring:
  jackson:
    time-zone: GMT+8
    date-format: yyyy-MM-dd HH:mm:ss
    
4、新建两个时间段的秒杀

5、修改 /coupon/seckillskurelation/list接口 查询该场次对应的商品
````
# 二、秒杀模块环境准备
````
1、新建秒杀模块

2、引入依赖

3、修改 application.properties配置文件
设置端口号
设置redis地址
开启服务注册与发现

4、编写配置类 ScheduledConfig
````
# 三、秒杀商品的定时上架
````
1、优惠服务编写/coupon/seckillsession/lates3DaySession 获取最近三天的活动

2、秒杀服务引入redis和分布式缓存

3、秒杀服务编写SeckillService.uploadSeckillSkuLatest3Days
远程调用优惠服务 获取最近三天的活动
远程调用商品服务 获取sku详情
并且上架这些商品

4、编写定时任务 SeckillSkuScheduled.uploadSeckillSkuLatest3Days
调用SeckillService.uploadSeckillSkuLatest3Days 定时上架商品

5、设置分布式锁解决不同机器的重复上架问题
````
# 四、查询秒杀商品
````
1、秒杀服务编写/getCurrentSeckillSkus接口 返回当前时间可以参与秒杀的商品信息

2、网关添加秒杀服务
- id: gulimall_seckill_route
  uri: lb://gulimall-seckill
  predicates:
    - Host=seckill.gulimall.com
    
3、C:\Windows\System32\drivers\etc hosts 添加域名映射
192.168.48.129(虚拟机ip) seckill.gulimall.com
````
# 五、商品详情查询秒杀信息
````
1、秒杀服务写/sku/seckill/{skuId} 商品详情查询秒杀信息

2、商品服务修改 接口/{skuId}.html
远程调用秒杀服务 商品详情查询秒杀信息
````
# 六、秒杀
````
1、修改配置文件 application.properties
spring.session.store-type=redis

2、复制GulimallSessionConfig配置类

3、新建登录拦截器

4、新建SeckillWebConfig配置类

5、修改配置文件 application.properties
spring.rabbitmq.host=127.0.0.1
spring.rabbitmq.port=5672
spring.rabbitmq.virtual-host=/
spring.rabbitmq.listener.simple.acknowledge-mode=manual

6、新建 MyGlobalRabbitConfig配置文件

7、订单服务新建 
秒杀队列order.seckill.order.queue
绑定订单交换机和秒杀队列

8、订单服务新建监听器 OrderSeckillListener监听秒杀队列

9、秒杀服务编写/kill接口 商品进行秒杀(秒杀开始)
````
